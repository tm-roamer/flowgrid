{"version":3,"file":"flowgrid.js","sources":["../src/config.js","../src/cache.js","../src/utils.js","../src/dragdrop.js","../src/event.js","../src/fg-container.vue","../src/fg-item.vue","../src/index.js"],"sourcesContent":["\n// 常量\nexport const CONSTANT = {\n\tTHROTTLE_TIME: 15,                             \t  // 节流函数的间隔时间, 单位ms, FPS = 1000 / THROTTLE_TIME\n\tTHROTTLE_LAZY_TIME: 100\t\t\t\t\t\t\t\t\t\t\t\t\t\t// 节流函数的懒执行间隔时间, 单位ms\n}\n\n// 全局配置\nexport const globalConfig = {\n\trow: 7,                                            // 网格布局的默认行,默认7行\n\tcol: 12,                                           // 网格布局的默认列,默认12列\n\tdistance: 5,                                       // 触发拖拽的拖拽距离,默认5px\n\tdraggable: true,                                   // 是否允许拖拽, 默认允许\n\tresizable: true,                                   // 是否允许缩放, 默认允许\n\tnodeMinW: 2,                                       // 节点块的最小宽度, 默认占2格\n\tnodeMinH: 2,                                       // 节点块的最小高度, 默认占2格\n\toverflow: 5,                                       // 当拖拽或缩放超出网格容器的溢出像素\n\tpadding: {                                         // 节点块之间的间距, 默认都为5px\n\t\ttop: 5,\n\t\tleft: 5,\n\t\tright: 5,\n\t\tbottom: 5\n\t},\n\tcellScale: {                                       // 单元格的宽高比例, 默认16:9\n\t\tw: 16,\n\t\th: 9\n\t},\n\taddNodeSize: {                                     // 添加节点的默认尺寸\n\t\tx: 0,\n\t\ty: 0,\n\t\tw: 2,\n\t\th: 2\n\t}\n}\n","// 缓存对象\nlet cache = {\n\tinit: function () {\n\t\tif (!this.arr) this.arr = [];\n\t},\n\tget: function (idx) {\n\t\t// 避免0的情况, if条件判断麻烦\n\t\treturn this.arr[idx - 1];\n\t},\n\tset: function (obj) {\n\t\tthis.arr.push(obj);\n\t\treturn this.index();\n\t},\n\tremove: function(index) {\n\t\tthis.arr.splice(index, 1);\n\t},\n\tindex: function () {\n\t\treturn this.arr.length;\n\t},\n\tlist: function() {\n\t\treturn this.arr;\n\t}\n};\n\nexport default cache;\n","import {CONSTANT} from './config'\n\nlet utils = {\n\t// 节流函数\n\tthrottle: function (now) {\n\t\tlet time = new Date().getTime();\n\t\tthis.throttle = function (now) {\n\t\t\tif (now - time > CONSTANT.THROTTLE_TIME) {\n\t\t\t\ttime = now;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis.throttle(now);\n\t},\n\t// 节流函数懒执行\n\tthrottleLazyId: 'throttleLazyId',\n\tthrottleLazy: function (ck) {\n\t\tclearTimeout(this.throttleLazyId);\n\t\tthis.throttleLazyId = setTimeout(function () {\n\t\t\tck && typeof ck === 'function' && ck();\n\t\t}, CONSTANT.THROTTLE_LAZY_TIME);\n\t},\n\t// 查找DOM节点\n\tsearchUp: function (ele, type) {\n\t\tif (ele === document.body || ele === document) return undefined;   // 向上递归到顶就停\n\t\tif (ele.classList.contains(type)) return ele;\n\t\treturn this.searchUp(ele.parentNode, type);\n\t}\n}\n\nexport default utils;\n","import cache from './cache'\nimport utils from './utils'\n\n// 拖拽对象\nlet dragdrop = {\n\tisResize: false,            // 是否放大缩小\n\tdragNode: null,             // 拖拽节点的的关联的fg-item的vue对象\n\tdragElement: null,\t\t\t\t\t// 拖拽节点dom对象\n\tdragStart: function (event, offsetX, offsetY, ele, isResize) {\n\t\t// 取得vue网格对象 flowgrid === fg-container.vue\n\t\tvar container = this.container = utils.searchUp(ele, 'fg-layout');\n\t\tvar flowgrid = this.flowgrid = cache.get(container.getAttribute('index'));\n\t\t// 配置项, 禁用拖拽\n\t\tif (!flowgrid.opt.draggable) return;\n\t\t// 取得当前vue被拖拽节点\n\t\tvar item = flowgrid.$children[ele.getAttribute('index') * 1];\n\t\t// 留存备份一份 this.dragNode === fg-item.vue\n\t\tthis.dragNode = item;\n\t\t// 将当前vue节点变成占位符, 控制样式\n\t\titem.placeholder = true;\n\t\t// 显示拖拽节点\n\t\tflowgrid.isDrag = true;\n\t\t// 将当前dom节点的内容区复制一份到拖拽节点\n\t\tvar dragElement = this.dragElement = container.querySelector('.fg-item-dragdrop');\n\t\tdragElement.setAttribute(\"style\", ele.getAttribute(\"style\"));\n\t\tdragElement.innerHTML = ele.innerHTML;\n\n\t\t// 计算偏移量, 点击节点时: 点击位置与节点的左上角定点的偏移距离\n\t\tvar containerOffset = container.getBoundingClientRect();\n\t\tthis.containerX = containerOffset.left;\n\t\tthis.containerY = containerOffset.top;\n\t\t// 判断是否点击了放大缩小\n\t\tif (isResize) {\n\t\t\tthis.isResize = isResize;\n\t\t\tthis.offsetX = offsetX || 0;\n\t\t\tthis.offsetY = offsetY || 0;\n\t\t\t// 执行回调\n\t\t\tflowgrid.resizeStart(item);\n\t\t} else {\n\t\t\tvar targetOffset = event.target.getBoundingClientRect();\n\t\t\tvar eleOffset = ele.getBoundingClientRect();\n\t\t\tthis.offsetX = targetOffset.left - eleOffset.left + offsetX || 0;\n\t\t\tthis.offsetY = targetOffset.top - eleOffset.top + offsetY || 0;\n\t\t\t// 执行回调\n\t\t\tflowgrid.dragStart(item);\n\t\t}\n\t},\n\tdrag: function (event) {\n\t\tif (!this.dragNode) return;\n\t\t// 赋初值\n\t\tthis.prevX || (this.prevX = event.clientX);\n\t\tthis.prevY || (this.prevY = event.clientY);\n\t\t// 计算位移\n\t\tthis.dx = event.clientX - this.prevX;\n\t\tthis.dy = event.clientY - this.prevY;\n\t\t// 保存当前坐标变成上一次的坐标\n\t\tthis.prevX = event.clientX;\n\t\tthis.prevY = event.clientY;\n\t\t// 转换坐标\n\t\tthis.pageX = event.clientX;\n\t\tthis.pageY = event.clientY;\n\t\t// 判断是缩放还是拖拽\n\t\tthis.isResize ? this.resize() : this.position()\n\t},\n\tposition: function () {\n\t\tvar flowgrid = this.flowgrid;\n\t\tvar x = this.pageX - this.containerX - this.offsetX;\n\t\tvar y = this.pageY - this.containerY - this.offsetY;\n\t\t// 计算拖拽节点的坐标\n\t\tthis.dragElement.style.cssText += ';transform: translate(' + x + 'px,' + y + 'px);';\n\t\t// 极值判断\n\t\tvar maxW = flowgrid.opt.containerW;\n\t\tvar eleW = parseInt(this.dragElement.style.width);\n\t\tx < 0 && (x = 0);\n\t\ty < 0 && (y = 0);\n\t\tx + eleW > maxW && (x = maxW - eleW);\n\t\t// 当前拖拽节点的坐标, 转换成对齐网格的坐标\n\t\tvar node = this.dragNode.node;\n\t\tvar nodeX = Math.round(x / flowgrid.opt.cellW_Int);\n\t\tvar nodeY = Math.round(y / flowgrid.opt.cellH_Int);\n\t\t// 判断坐标是否变化\n\t\tif (node.x !== nodeX || node.y !== nodeY) {\n\t\t\tnode.x = nodeX;\n\t\t\tnode.y = nodeY;\n\t\t\tflowgrid.overlap(node, this.dx, this.dy, this.isResize);\n\t\t\t// 执行回调\n\t\t\tflowgrid.drag(this.dragNode);\n\t\t}\n\t},\n\tresize: function () {\n\t\t// debugger;\n\t\tvar flowgrid = this.flowgrid,\n\t\t\topt = flowgrid.opt,\n\t\t\tnode = this.dragNode.node,\n\t\t\tminW = node.minW * opt.cellW_Int - opt.padding.left - opt.padding.right - opt.overflow,\n\t\t\tminH = node.minH * opt.cellH_Int - opt.padding.top - opt.padding.bottom - opt.overflow,\n\t\t\ttranslate = this.dragElement.style.transform,\n\t\t\tcoord = translate.replace(/translate.*\\(/ig, '').replace(/\\).*$/ig, '').replace(/px/ig, '').split(','),\n\t\t\tx = parseInt(coord[0]),\n\t\t\ty = parseInt(coord[1]),\n\t\t\tw = this.pageX - this.containerX - x + this.offsetX,\n\t\t\th = this.pageY - this.containerY - y + this.offsetY;\n\t\t// 极值判断\n\t\tvar maxW = opt.containerW;\n\t\tw < minW && (w = minW);\n\t\th < minH && (h = minH);\n\t\tw + x > maxW && (w = maxW - x + opt.overflow);\n\t\t// 计算拖拽节点的宽高\n\t\tthis.dragElement.style.cssText += ';width: ' + w + 'px; height: ' + h + 'px;';\n\t\t// 判断宽高是否变化\n\t\tvar nodeW = Math.ceil(w / opt.cellW_Int);\n\t\tvar nodeH = Math.ceil(h / opt.cellH_Int);\n\t\tif (node.w !== nodeW || node.h !== nodeH) {\n\t\t\tnode.w = nodeW;\n\t\t\tnode.h = nodeH;\n\t\t\tflowgrid.overlap(node, this.dx, this.dy, this.isResize);\n\t\t\t// 执行回调\n\t\t\tflowgrid.resize(this.dragNode);\n\t\t}\n\t},\n\tdragEnd: function (event) {\n\t\tif (!this.dragNode) return;\n\t\t// 执行回调\n\t\tif (this.isResize) {\n\t\t\tthis.flowgrid.resizeEnd(this.dragNode)\n\t\t} else {\n\t\t\tthis.flowgrid.dragEnd(this.dragNode)\n\t\t}\n\t\t// 清空拖拽节点样式和内容\n\t\tthis.dragElement.removeAttribute('style');\n\t\tthis.dragElement.innerHTML = '';\n\t\t// 隐藏拖拽节点\n\t\tthis.flowgrid.isDrag = false;\n\t\t// 取消占位符样式\n\t\tthis.dragNode.placeholder = false;\n\t\t// 重置状态\n\t\tthis.isResize = false;\n\t\t// 临时变量\n\t\tdelete this.container;\n\t\tdelete this.flowgrid;\n\t\tdelete this.dragNode;\n\t\tdelete this.dragElement;\n\t\t// 删除偏移量\n\t\tdelete this.dx;\n\t\tdelete this.dy;\n\t\tdelete this.prevX;\n\t\tdelete this.prevY;\n\t\tdelete this.pageX;\n\t\tdelete this.pageY;\n\t\tdelete this.offsetX;\n\t\tdelete this.offsetY;\n\t\tdelete this.containerX;\n\t\tdelete this.containerY;\n\t}\n}\n\nexport default dragdrop;\n","import utils from './utils'\nimport dragdrop from './dragdrop'\n\n//配置选项\nlet configOption;\n// 事件处理对象\nlet handleEvent = {\n\tinit: function (isbind, opt) {\n\t\tif (this.isbind) return;\n\t\tconfigOption = opt;\n\t\tthis.isbind = isbind;\n\t\tthis.unbindEvent();\n\t\tthis.bindEvent();\n\t},\n\tdestroy: function () {\n\t\tthis.unbindEvent();\n\t},\n\tbindEvent: function () {\n\t\tdocument.addEventListener('mousedown', this.mouseDown, false);\n\t\tdocument.addEventListener('mousemove', this.mouseMove, false);\n\t\tdocument.addEventListener('mouseup', this.mouseUp, false);\n\t\tdocument.addEventListener('click', this.click, true);\n\t\tthis.isbind = true;\n\t},\n\tunbindEvent: function () {\n\t\tdocument.removeEventListener('mousedown', this.mouseDown, false);\n\t\tdocument.removeEventListener('mousemove', this.mouseMove, false);\n\t\tdocument.removeEventListener('mouseup', this.mouseUp, false);\n\t\tdocument.removeEventListener('click', this.click, true);\n\t\tthis.isbind = false;\n\t},\n\tmouseDown: function (event) {\n\t\tlet self = handleEvent;\n\t\t//判断按下的是否是鼠标左键(或者是否是设置的键)\n\t\tif(!self.ifLeft(event))\treturn;\n\t\t// 是否点击了拖拽节点\n\t\tlet ele = self.ele = utils.searchUp(event.target, 'fg-item');\n\t\tif (ele) {\n\t\t\t// 设置拖拽过程中禁用文本选中\n\t\t\tdocument.body.classList.add('fg-user-select-none');\n\t\t\t// 判断是否是缩放\n\t\t\tif (event.target.classList.contains('fg-item-zoom-bar')) {\n\t\t\t\tself.isResize = true;\n\t\t\t}\n\t\t\t// 记录位置, 通过比较拖拽距离来判断是否是拖拽, 如果是拖拽则阻止冒泡. 不触发点击事件\n\t\t\tself.dragStart = true;\n\t\t\tself.distance = configOption.distance;\n\t\t\tself.distanceX = event.pageX;\n\t\t\tself.distanceY = event.pageY;\n\t\t\tself.offsetX = event.offsetX || 0;\n\t\t\tself.offsetY = event.offsetY || 0;\n\t\t}\n\t},\n\tmouseMove: function (event) {\n\t\tlet self = handleEvent;\n\t\tif(!self.ifLeft(event))\treturn;\n\t\tif (!self.ele) return;\n\t\tif (self.dragStart && self.isDrag(event)) {\n\t\t\tself.dragStart = false;\n\t\t\tdragdrop.dragStart(event, self.offsetX, self.offsetY, self.ele, self.isResize);\n\t\t\treturn;\n\t\t}\n\t\tutils.throttle(new Date().getTime()) && dragdrop.drag(event);\n\t},\n\tmouseUp: function (event) {\n\t\t// 清理临时变量\n\t\tlet self = handleEvent;\n\n\t\tif(!self.ifLeft(event))\treturn;\n\t\tdocument.body.classList.remove('fg-user-select-none');\n\t\tdragdrop.dragEnd(event);\n\n\t\tdelete self.distance;\n\t\tdelete self.distanceX;\n\t\tdelete self.distanceY;\n\t\tdelete self.offsetX;\n\t\tdelete self.offsetY;\n\t\tdelete self.isResize;\n\t},\n\tclick: function (event) {\n\t\tlet self = handleEvent;\n\t\tif (self.dragStart === false) {\n\t\t\tevent.stopPropagation();\n\t\t\tdelete self.dragStart\n\t\t}\n\t},\n\tisDrag: function (event) {\n\t\tvar self = handleEvent,\n\t\t\t\tdistanceX = Math.abs(event.pageX - self.distanceX || 0),\n\t\t\t\tdistanceY = Math.abs(event.pageY - self.distanceY || 0);\n\t\tif (self.distance < distanceX || self.distance < distanceY) {\n\t\t\treturn true;\n\t\t}\n\t},\n\t//判断是否是按下了左键, 0为左键\n\tifLeft: function (event) {\n\t\treturn event.button === 0;\n\t}\n}\n\nexport default handleEvent;\n","<template>\n  <div class=\"fg-container\">\n    <div class=\"fg-layout\"\n         :index=\"index\"\n         :class=\"{'fg-no-draggable': !opt.draggable, 'fg-no-resizable': !opt.resizable}\">\n      <slot></slot>\n      <!-- 跟随鼠标移动的拖拽节点 -->\n      <div class=\"fg-item-dragdrop\" v-show=\"isDrag\"></div>\n    </div>\n  </div>\n</template>\n\n<script>\n\n  import {globalConfig} from './config'\n  import cache from './cache'\n  import handleEvent from './event'\n\n  export default {\n    name: 'fg-container',\n    props: [\n      'setting',\n      'nodes'\n    ],\n    computed: {\n      opt: function () {\n        let options = Object.assign({}, globalConfig, this.setting || {});\n        this.computeCell(options);\n        return options;\n      }\n    },\n    data () {\n      return {\n        area: [],\n        index: 1,\n        isDrag: false,\n      }\n    },\n    methods: {\n      // 计算单元格\n      computeCell: function (opt) {\n        opt.cellW = opt.containerW / opt.col;\n        opt.cellH = opt.cellW / opt.cellScale.w * opt.cellScale.h;\n        opt.cellW_Int = Math.floor(opt.cellW);\n        opt.cellH_Int = Math.floor(opt.cellH);\n      },\n      init: function () {\n        handleEvent.init(true, this.opt);\n        // 缓存对象\n        cache.init();\n        this.index = cache.set(this);\n        this.load();\n      },\n      load: function() {\n        // 初始矩阵区域并布局\n        this.buildArea();\n        this.layout();\n      },\n      // 构建网格区域\n      buildArea: function () {\n        let max = this.getMaxRowAndCol();\n        for (let r = 0; r < max.row; r++) {\n          this.area[r] = new Array(max.col);\n        }\n        this.putNodes();\n      },\n      // 取得区域中的最大行和列\n      getMaxRowAndCol: function () {\n        let opt = this.opt;\n        let nodes = this.nodes;\n        let max = {\n          row: opt.row,\n          col: opt.col\n        };\n        if (nodes && nodes.length > 0) {\n          for (let n of nodes) {\n            if (n.y + n.h > max.row) {\n              max.row = n.y + n.h;\n            }\n            if (n.x + n.w > max.col) {\n              max.col = n.x + n.w;\n            }\n          }\n        }\n        return max;\n      },\n      // 将数据铺进网格布局\n      putNodes: function () {\n        let r, c, rlen, clen;\n        for (let node of this.nodes) {\n          for (r = node.y, rlen = node.y + node.h; r < rlen; r++) {\n            for (c = node.x, clen = node.x + node.w; c < clen; c++) {\n              this.area[r][c] = node.id;\n            }\n          }\n        }\n      },\n      // 自动扫描空位添加节点\n      getNodeCoord: function (node) {\n        let nodes = this.nodes;\n        let area = this.area;\n        if (nodes.length === 0) return node;\n        var r, c, maxCol = area[0].length;\n        for (r = 0; r < area.length; r = r + 1) {\n          node.y = r;\n          for (c = 0; c < area[0].length; c = c + 1) {\n            node.x = c;\n            if (node.x + node.w > maxCol) {\n              node.x = 0;\n            }\n            if (!this.collision(area, node))\n              return node;\n          }\n        }\n        node.x = 0;  // area区域都占满了, 另起一行\n        node.y = r;\n        return node;\n      },\n      // 碰撞检测, 从左到右, 从上到下扫描\n      collision: function (area, node) {\n        for (let r = node.y; r < node.y + node.h; r++)\n          for (let c = node.x; c < node.x + node.w; c++)\n            if (area[r] && (area[r][c] || area[r][c] == 0))\n              return true;\n      },\n      // 流布局\n      layout: function () {\n        // 原理: 遍历数据集, 寻找节点上面是否有空行, 修改node.y, 进行上移.\n        for (let node of this.nodes) {\n          let y = this.findEmptyLine(node);\n          node.y > y && this.moveUp(node, y);\n        }\n      },\n      // 寻找空行, 扫描找到最接近顶部的空行是第几行\n      findEmptyLine: function (node) {\n        let r, c, cell, area = this.area;\n        for (r = node.y - 1; r >= 0; r--) {\n          for (c = node.x; c < node.x + node.w; c++) {\n            cell = area[r][c];\n            if (cell || cell == 0) {\n              return r + 1;\n            }\n          }\n        }\n        return 0;\n      },\n      // 上移\n      moveUp: function (node, newRow, newId) {\n        node.y = newRow;\n        newId && (node.id = newId)\n        for (let r = node.y; r < node.y + node.h; r++)\n          for (let c = node.x; c < node.x + node.w; c++)\n            this.area[r][c] = node.id;\n      },\n      // 碰撞检测, 两个矩形是否发生碰撞\n      checkHit: function (n, node) {\n        var result = false;\n        if ((n.x + n.w > node.x) && (n.x < node.x + node.w)) {\n          if ((n.y + n.h > node.y) && (n.y < node.y + node.h)) {\n            result = true;\n          }\n        }\n        return result;\n      },\n      // 节点重叠, 拖拽节点过程中, 将所有节点坐标重新计算\n      overlap: function (node, dx, dy, isResize) {\n        var nodes = this.nodes,\n          dx = dx || 0,\n          dy = dy || 0,\n          offsetNode = null,\n          offsetUnderY = 0,\n          offsetUpY = 0,\n          isResize = isResize || false,\n          checkHit = this.checkHit;\n        // 向下, 向左, 向右插入节点\n        if (!isResize) {\n          for(let n of nodes) {\n            if (n !== node && checkHit(n, node)) {\n              var val = n.y + n.h - node.y;\n              if (val > offsetUnderY) {\n                offsetUnderY = val;\n                offsetNode = n;\n              }\n            }\n          }\n          if (offsetNode) {\n            // 判断插入点应该上移还是下移, 通过重叠点的中间值h/2来判断\n            var median = offsetNode.h / 2 < 1 ? 1 : Math.floor(offsetNode.h / 2);\n            // 计算差值, 与中间值比较, dy > 2 下移(2是优化, 防止平移上下震动), 拿y+h来和中间值比较\n            var difference = (dy >= 2 && dy >= dx) ? node.y + node.h - offsetNode.y : node.y - offsetNode.y;\n            // 大于中间值, 求出下面那部分截断的偏移量, 等于是怕上下顺序连续的块,会错过互换位置\n            if (difference >= median) {\n              node.y = node.y + offsetUnderY;\n            }\n          }\n        }\n        // 向上插入节点\n        for(let n of nodes) {\n          if (n !== node && checkHit(n, node)) {\n            var val = node.y - n.y;\n            offsetUpY = val > offsetUpY ? val : offsetUpY;\n          }\n        }\n        // 重新计算y值\n        for(let n of nodes) {\n          if (n !== node) {\n            if ((n.y < node.y && node.y < n.y + n.h) || node.y <= n.y) {\n              n.y = n.y + node.h + offsetUpY;\n            }\n          }\n        }\n        return this;\n      },\n\n      // 回调函数, 开始拖拽\n      dragStart: function (item) {\n        this.$emit('dragStart', this, item);\n      },\n      // 回调函数, 正在拖拽\n      drag: function(item) {\n        this.$emit('drag', this, item);\n      },\n      // 回调函数, 结束拖拽\n      dragEnd: function (item) {\n        this.$emit('dragEnd', this, item);\n      },\n      // 回调函数, 开始缩放\n      resizeStart: function (item) {\n        this.$emit('resizeStart', this, item);\n      },\n      // 回调函数, 正在拖拽\n      resize: function(item) {\n        this.$emit('resize', this, item);\n      },\n      // 回调函数, 结束缩放\n      resizeEnd: function (item) {\n        this.$emit('resizeEnd', this, item);\n      }\n    },\n    created () {\n      // 早于fg-item的钩子mounted执行\n      this.init();\n    },\n    beforeUpdate () {\n      // 数据即将更新时重置区域, 并应用布局\n      this.load();\n    },\n    updated () {},\n    mounted () {},\n    destroyed () {\n      handleEvent.destroy();\n    }\n  }\n</script>\n\n<style>\n  /* 拖拽过程中阻止文本选中 */\n  body.fg-user-select-none {\n    user-select: none !important;\n  }\n\n  /* 响应式 */\n  @media screen and (max-width: 767px) {\n    .fg-layout {\n      width: auto !important;\n      margin: 0 10px;\n    }\n\n    .fg-layout:after {\n      content: \"\";\n      clear: both;\n    }\n\n    .fg-layout .fg-item-zoom-bar {\n      display: none;\n    }\n\n    .fg-item {\n      position: static;\n      width: 100% !important;\n      height: auto !important;\n      float: left !important;\n      transform: translate(0, 0) !important;\n      margin-bottom: 10px;\n    }\n  }\n\n  /* 插件外容器的样式 */\n  .fg-container {\n    position: relative;\n    z-index: 1;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n  }\n\n  /* 网络布局的外容器 */\n  .fg-layout {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  /* 当禁止缩放, 隐藏缩放句柄 */\n  .fg-layout.fg-no-resizable .fg-item-zoom-bar {\n    display: none;\n  }\n\n  /* 当禁用缩放或者拖拽, 恢复鼠标形状 */\n  .fg-layout.fg-no-draggable .fg-item,\n  .fg-layout.fg-no-resizable .fg-item {\n    cursor: default;\n  }\n\n  /* 节点块的样式 */\n  .fg-item {\n    cursor: pointer;\n    position: absolute;\n    z-index: 10;\n    background-color: rgb(19, 19, 19);\n    color:rgba(255,255,255,0.7);\n  }\n\n  /* 节点块的动画样式 */\n  .fg-item-animate {\n    -webkit-transform: translate3d(0, 0, 0);\n    -webkit-backface-visibility: hidden;\n    -webkit-transform-style: preserve-3d;\n    transition: transform 0.2s, height 0.2s, width 0.2s;\n  }\n\n  /* 拖拽过程中, 被拖拽的当前节点块补充占位样式 */\n  .fg-item-placeholder {\n    z-index: 1;\n  }\n  .fg-item-placeholder::before {\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background:rgba(64, 108, 176, 0.3);\n    z-index: 2;\n  }\n\n  /* 拖拽过程中, 被拖拽的节点 */\n  .fg-item-dragdrop {\n    position: absolute;\n    z-index: 100;\n    box-shadow: 2px 2px 2px rgba(144, 142, 142, 0.6);\n    opacity: 0.8;\n    background-color: rgb(19, 19, 19);\n  }\n\n  /* 节点块的内容区 */\n  .fg-item-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n\n  /* 节点块的缩放句柄 */\n  .fg-item-zoom-bar {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    height: 24px;\n    width: 24px;\n    overflow: hidden;\n    z-index: 1;\n    cursor: se-resize;\n  }\n  .fg-item-zoom-bar:before {\n    content: \"\";\n    position: absolute;\n    z-index: 100;\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n    background-color: #20a0ff;\n  }\n\n</style>\n","<template>\n  <div class=\"fg-item fg-item-animate\"\n       :class=\"{'fg-item-placeholder': placeholder}\"\n       :style=\"itemStyle\"\n       :fg-id=\"node.id\"\n       :index=\"index\">\n    <div class=\"fg-item-content\">\n      <slot></slot>\n    </div>\n    <div class=\"fg-item-zoom-bar\" :fg-id=\"node.id\" :index=\"index\"></div>\n  </div>\n</template>\n\n<script>\n\n  export default {\n    name: 'fg-item',\n    props: [\n      'node', // {id:'2', x: 0, y: 0, w: 4, h: 4, minW: 2, minH: 2}\n      'index' // node在nodes中的索引值\n    ],\n    computed: {\n      itemStyle: function () {\n        let opt = this.$parent.opt;\n        let node = this.node;\n        this.width = node.w * opt.cellW_Int - opt.padding.left - opt.padding.right;\n        this.height = node.h * opt.cellH_Int - opt.padding.top - opt.padding.bottom;\n        return {\n          transform: \"translate(\" + (node.x * opt.cellW_Int) + \"px,\" + (node.y * opt.cellH_Int) + \"px)\",\n          width: this.width + 'px',\n          height: this.height + 'px'\n        }\n      }\n    },\n    data () {\n      return {\n        placeholder: false,\n        width: 0,\n        height: 0\n      }\n    }\n  }\n</script>\n\n<style>\n</style>\n","import { version } from '../package.json';\nimport fgContainer from './fg-container.vue';\nimport fgItem from './fg-item.vue';\n\nexport default {\n\tversion,\n\tfgContainer,\n\tfgItem\n}\n"],"names":["CONSTANT","globalConfig","cache","arr","idx","obj","push","index","splice","length","utils","now","time","Date","getTime","throttle","THROTTLE_TIME","ck","throttleLazyId","setTimeout","THROTTLE_LAZY_TIME","ele","type","document","body","undefined","classList","contains","searchUp","parentNode","dragdrop","event","offsetX","offsetY","isResize","container","flowgrid","get","getAttribute","opt","draggable","item","$children","dragNode","placeholder","isDrag","dragElement","querySelector","setAttribute","innerHTML","containerOffset","getBoundingClientRect","containerX","left","containerY","top","resizeStart","targetOffset","target","eleOffset","dragStart","prevX","clientX","prevY","clientY","dx","dy","pageX","pageY","resize","position","x","y","style","cssText","maxW","containerW","eleW","parseInt","width","node","nodeX","Math","round","cellW_Int","nodeY","cellH_Int","overlap","drag","minW","padding","right","overflow","minH","bottom","translate","transform","coord","replace","split","w","h","nodeW","ceil","nodeH","resizeEnd","dragEnd","removeAttribute","configOption","handleEvent","isbind","unbindEvent","bindEvent","addEventListener","mouseDown","mouseMove","mouseUp","click","removeEventListener","self","ifLeft","add","distance","distanceX","distanceY","remove","stopPropagation","abs","button","options","Object","assign","setting","computeCell","cellW","col","cellH","cellScale","floor","init","set","load","buildArea","layout","max","getMaxRowAndCol","r","row","area","Array","putNodes","nodes","n","c","rlen","clen","id","maxCol","collision","findEmptyLine","moveUp","cell","newRow","newId","result","offsetNode","offsetUnderY","offsetUpY","checkHit","val","median","difference","$emit","destroy","$parent","height"],"mappings":"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"}